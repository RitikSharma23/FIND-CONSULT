
<main class="page" >

   <h2>Upload ,Crop and save.</h2>
   <div class="box">
       <input type="file" id="file-input">
   </div>

   <div class="box-2" >
       <div class="result"></div>
   </div>

   <div class="box-2 img-result hide" >
       <img class="cropped" src="" alt="" height="100px" id="myImg">
   </div>

   <div class="box" >
       <div class="options hide">
           <label> Width</label>
           <input type="number" class="img-w" value="300" min="100" max="1200" />
       </div>
       <button class="btn save hide" id="savebtn">Save</button>
       <button class="btn save hide" id="uploadbtn">upload</button>
       <a href="" class="btn download hide">Download</a>
   </div>
</main>

<script>
  var firebaseConfig = {
    apiKey: "AIzaSyDm3wPO6QhN0ezPF6hNprGw4C68Lef31fY",
    authDomain: "test-f98fd.firebaseapp.com",
    projectId: "test-f98fd",
    storageBucket: "test-f98fd.appspot.com",
    messagingSenderId: "533575527457",
    appId: "1:533575527457:web:0131ad8ed9712049304760"
  };
  firebase.initializeApp(firebaseConfig);
</script>


<script>
  document.getElementById("uploadbtn").addEventListener("click", () => {
    var imgUrl = document.getElementById('myImg').src;

    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }

    fetch(imgUrl)
      .then(response => response.blob())
      .then(blob => {
        var storageRef = firebase.storage().ref();
        var timestamp = new Date().getTime();
        var imageName = 'image_' + timestamp + '.jpg';
        var imageRef = storageRef.child(imageName);
        var metadata = { contentType: 'image/jpeg' };
        var uploadTask = imageRef.put(blob, metadata);

        uploadTask.on('state_changed', null, null, function() {
          uploadTask.snapshot.ref.getDownloadURL().then(function(downloadURL) {
            var imageUrl = downloadURL;
            console.log(imageUrl);
          });
        });
      })
      .catch(error => {
        console.error('Error fetching image data:', error);
      });
  });
</script>

<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-storage.js"></script>

<style>
    .box-2 {
      height: 200px;
      width: 400px;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    .result img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }
    
    </style>
    
    